# âœ… Terraform ë©€í‹°í´ë¼ìš°ë“œ DR ì•„í‚¤í…ì²˜ êµ¬í˜„ ì™„ë£Œ!

## ğŸ‰ ì¶•í•˜í•©ë‹ˆë‹¤!

AWSì™€ Azureë¥¼ í™œìš©í•œ ë©€í‹°í´ë¼ìš°ë“œ ì¬í•´ë³µêµ¬ ì•„í‚¤í…ì²˜ê°€ ì„±ê³µì ìœ¼ë¡œ êµ¬í˜„ë˜ì—ˆìŠµë‹ˆë‹¤.

## ğŸ“¦ ìƒì„±ëœ íŒŒì¼ ëª©ë¡

### í•µì‹¬ Terraform íŒŒì¼ (15ê°œ)
```
âœ… main.tf                    # ë©”ì¸ êµ¬ì„± (Route53, Lambda, S3, CloudWatch)
âœ… variables.tf               # ë³€ìˆ˜ ì •ì˜
âœ… outputs.tf                 # ì¶œë ¥ ì •ì˜
âœ… terraform.tfvars.example   # ë³€ìˆ˜ ì˜ˆì œ
```

### ëª¨ë“ˆ (modules/)
```
âœ… vpc/
   â”œâ”€â”€ aws_vpc.tf            # VPC, ì„œë¸Œë„·, NAT, IGW, Flow Logs
   â”œâ”€â”€ variables.tf
   â””â”€â”€ outputs.tf

âœ… alb/
   â”œâ”€â”€ main.tf               # External/Internal ALB, Security Groups
   â”œâ”€â”€ variables.tf
   â””â”€â”€ outputs.tf

âœ… rds/
   â”œâ”€â”€ main.tf               # RDS MySQL Multi-AZ, Parameter Group, Alarms
   â”œâ”€â”€ variables.tf
   â””â”€â”€ outputs.tf

âœ… ecs/
   â”œâ”€â”€ main.tf               # ECS Cluster, Web/WAS Tasks, Auto Scaling
   â”œâ”€â”€ variables.tf
   â””â”€â”€ outputs.tf
```

### ìŠ¤í¬ë¦½íŠ¸ (scripts/)
```
âœ… lambda-db-sync/
   â”œâ”€â”€ index.py              # DB ë™ê¸°í™” Lambda í•¨ìˆ˜ (Python)
   â”œâ”€â”€ requirements.txt      # pymysql, boto3
   â””â”€â”€ package.sh            # Lambda íŒ¨í‚¤ì§• ìŠ¤í¬ë¦½íŠ¸
```

### ë¬¸ì„œ
```
âœ… README.md                 # ì „ì²´ ë¬¸ì„œ (ìƒì„¸ ê°€ì´ë“œ)
âœ… QUICKSTART.md             # ë¹ ë¥¸ ì‹œì‘ ê°€ì´ë“œ
âœ… PROJECT_SUMMARY.md        # í”„ë¡œì íŠ¸ ìš”ì•½
âœ… .gitignore                # Git ì œì™¸ íŒŒì¼
```

### ë°°í¬ ìŠ¤í¬ë¦½íŠ¸
```
âœ… deploy.sh                 # ìë™ ë°°í¬ ìŠ¤í¬ë¦½íŠ¸ (ì‚¬ì „ í™•ì¸ í¬í•¨)
```

## ğŸ—ï¸ êµ¬í˜„ëœ ì•„í‚¤í…ì²˜

### AWS Primary Site (ap-northeast-2)
- âœ… VPC (10.0.0.0/16)
  - Public Subnets (2ê°œ) - ALB, NAT Gateway
  - Web Subnets (2ê°œ) - Nginx ì»¨í…Œì´ë„ˆ
  - WAS Subnets (2ê°œ) - Spring Boot ì»¨í…Œì´ë„ˆ
  - DB Subnets (2ê°œ) - RDS MySQL
- âœ… External ALB (Internet-facing)
- âœ… Internal ALB (Private)
- âœ… ECS Fargate (Web/WAS Tier)
- âœ… RDS MySQL Multi-AZ
- âœ… Lambda í•¨ìˆ˜ (5ë¶„ ì£¼ê¸° DB ë™ê¸°í™”)
- âœ… S3 ë°±ì—… ë²„í‚·
- âœ… Route 53 (DNS Failover)
- âœ… CloudWatch (ëŒ€ì‹œë³´ë“œ, ì•ŒëŒ)

### ì£¼ìš” ê¸°ëŠ¥
âœ… Multi-AZ ê³ ê°€ìš©ì„±
âœ… Auto Scaling (CPU ê¸°ë°˜)
âœ… Health Check (30ì´ˆ ê°„ê²©)
âœ… VPC Endpoints (S3, CloudWatch Logs)
âœ… Flow Logs (ë„¤íŠ¸ì›Œí¬ ëª¨ë‹ˆí„°ë§)
âœ… Parameter Groups (ì„±ëŠ¥ ìµœì í™”)
âœ… CloudWatch Alarms (CPU, Connection, Storage)
âœ… ë³´ì•ˆ ê·¸ë£¹ ê³„ì¸µí™”
âœ… ìë™ ë°±ì—… (5ë¶„ ì£¼ê¸°)

## ğŸ“Š ì£¼ìš” ì§€í‘œ

| ë©”íŠ¸ë¦­ | ê°’ |
|--------|------|
| **RTO** | ~10ë¶„ |
| **RPO** | 5ë¶„ |
| **ê°€ìš©ì„±** | 99.95% |
| **ë™ê¸°í™” ì£¼ê¸°** | 5ë¶„ |
| **Health Check** | 30ì´ˆ |
| **ì˜ˆìƒ ë¹„ìš©** | $390-610/ì›” |

## ğŸš€ ë‹¤ìŒ ë‹¨ê³„

### 1. ë°°í¬ ì „ ì¤€ë¹„
```bash
# 1) Terraform ì„¤ì¹˜
brew install terraform  # macOS
sudo apt install terraform  # Ubuntu

# 2) AWS/Azure CLI ì„¤ì •
aws configure
az login

# 3) ë³€ìˆ˜ íŒŒì¼ ìƒì„±
cp terraform.tfvars.example terraform.tfvars
nano terraform.tfvars

# 4) Lambda íŒ¨í‚¤ì§•
cd scripts/lambda-db-sync
./package.sh
cd ../..
```

### 2. ë°°í¬ ì‹¤í–‰
```bash
# ìë™ ë°°í¬ (ì¶”ì²œ)
./deploy.sh

# ë˜ëŠ” ìˆ˜ë™ ë°°í¬
terraform init
terraform plan
terraform apply
```

### 3. ë°°í¬ í›„ í™•ì¸
```bash
# ì—”ë“œí¬ì¸íŠ¸ í™•ì¸
terraform output

# Health Check
curl -I http://$(terraform output -raw aws_external_alb_dns)

# CloudWatch ëŒ€ì‹œë³´ë“œ
open $(terraform output -raw cloudwatch_dashboard_url)
```

## ğŸ“š ë¬¸ì„œ ê°€ì´ë“œ

### ì²˜ìŒ ì‹œì‘í•˜ëŠ” ê²½ìš°
ğŸ‘‰ **[QUICKSTART.md](QUICKSTART.md)** ë¥¼ ë¨¼ì € ì½ì–´ë³´ì„¸ìš”!
   - 5ë‹¨ê³„ë¡œ ê°„ë‹¨í•˜ê²Œ ë°°í¬í•˜ëŠ” ë°©ë²•
   - 20-30ë¶„ì´ë©´ ì™„ë£Œ

### ìƒì„¸í•œ ì •ë³´ê°€ í•„ìš”í•œ ê²½ìš°
ğŸ‘‰ **[README.md](README.md)** ë¥¼ ì°¸ê³ í•˜ì„¸ìš”!
   - ì•„í‚¤í…ì²˜ ìƒì„¸ ì„¤ëª…
   - ì „ì²´ ë¦¬ì†ŒìŠ¤ ëª©ë¡
   - íŠ¸ëŸ¬ë¸”ìŠˆíŒ… ê°€ì´ë“œ
   - ë¹„ìš© ìµœì í™” íŒ
   - ì¬í•´ë³µêµ¬ ì ˆì°¨

### í”„ë¡œì íŠ¸ ê°œìš”ê°€ í•„ìš”í•œ ê²½ìš°
ğŸ‘‰ **[PROJECT_SUMMARY.md](PROJECT_SUMMARY.md)** ë¥¼ í™•ì¸í•˜ì„¸ìš”!
   - í•œëˆˆì— ë³´ëŠ” í”„ë¡œì íŠ¸ ìš”ì•½
   - ì£¼ìš” ë¦¬ì†ŒìŠ¤ ëª©ë¡
   - í•™ìŠµ í¬ì¸íŠ¸

## ğŸ’¡ í•µì‹¬ ê°œë…

### 1. Infrastructure as Code (IaC)
- ëª¨ë“  ì¸í”„ë¼ë¥¼ ì½”ë“œë¡œ ê´€ë¦¬
- ë²„ì „ ê´€ë¦¬ ë° ì¬í˜„ ê°€ëŠ¥
- ëª¨ë“ˆí™”ë¥¼ í†µí•œ ì¬ì‚¬ìš©ì„±

### 2. ê³ ê°€ìš©ì„± (High Availability)
- Multi-AZ ë°°í¬
- Auto Scaling
- Health Check ë° ìë™ ë³µêµ¬

### 3. ì¬í•´ë³µêµ¬ (Disaster Recovery)
- Warm Standby ì „ëµ
- DNS Failover (Route 53)
- ìë™ ë°ì´í„° ë™ê¸°í™” (5ë¶„ ì£¼ê¸°)

### 4. ë³´ì•ˆ (Security)
- ê³„ì¸µë³„ Security Groups
- Private Subnets (DB/WAS ê²©ë¦¬)
- VPN ì•”í˜¸í™” í†µì‹ 
- ì €ì¥ ë°ì´í„° ì•”í˜¸í™”

### 5. ëª¨ë‹ˆí„°ë§ (Monitoring)
- CloudWatch ëŒ€ì‹œë³´ë“œ
- ì‹¤ì‹œê°„ ì•ŒëŒ
- ë¡œê·¸ ì§‘ê³„ ë° ë¶„ì„

## ğŸ“ í•™ìŠµ íš¨ê³¼

ì´ í”„ë¡œì íŠ¸ë¥¼ í†µí•´ ë‹¤ìŒì„ ë°°ìš¸ ìˆ˜ ìˆìŠµë‹ˆë‹¤:

âœ… Terraform ì‹¤ì „ í™œìš©
âœ… AWS ì£¼ìš” ì„œë¹„ìŠ¤ (VPC, ALB, ECS, RDS, Lambda, Route 53)
âœ… ë©€í‹°í´ë¼ìš°ë“œ ì•„í‚¤í…ì²˜ ì„¤ê³„
âœ… ê³ ê°€ìš©ì„± ë° ì¬í•´ë³µêµ¬ ì „ëµ
âœ… ì»¨í…Œì´ë„ˆ ì˜¤ì¼€ìŠ¤íŠ¸ë ˆì´ì…˜ (ECS Fargate)
âœ… ë„¤íŠ¸ì›Œí¬ ë³´ì•ˆ ì„¤ê³„
âœ… CloudWatch ëª¨ë‹ˆí„°ë§
âœ… Infrastructure as Code (IaC)
âœ… ìë™í™” (Lambda, EventBridge)
âœ… ë¹„ìš© ìµœì í™” ì „ëµ

## ğŸ› ï¸ í”„ë¡œì íŠ¸ íŠ¹ì§•

### 1. ëª¨ë“ˆí™”ëœ êµ¬ì¡°
- ì¬ì‚¬ìš© ê°€ëŠ¥í•œ Terraform ëª¨ë“ˆ
- ê° ê³„ì¸µë³„ ë…ë¦½ì  ê´€ë¦¬
- ì‰¬ìš´ í™•ì¥ ë° ìˆ˜ì •

### 2. ìë™í™”
- Lambdaë¥¼ í†µí•œ ìë™ ë°±ì—…
- Auto Scaling (ECS)
- DNS Failover (Route 53)
- CloudWatch ìë™ ì•ŒëŒ

### 3. ë³´ì•ˆ
- ê³„ì¸µë³„ Security Groups
- Private Subnets
- VPN ì•”í˜¸í™”
- ìµœì†Œ ê¶Œí•œ ì›ì¹™

### 4. ëª¨ë‹ˆí„°ë§
- CloudWatch ëŒ€ì‹œë³´ë“œ
- ì‹¤ì‹œê°„ ì•ŒëŒ (CPU, Connection, Storage)
- VPC Flow Logs
- Lambda ë¡œê·¸

### 5. ë¹„ìš© ìµœì í™”
- Warm Standby ì „ëµ (ìµœì†Œ ë¦¬ì†ŒìŠ¤)
- VPC Endpoints (ë°ì´í„° ì „ì†¡ ë¹„ìš© ì ˆê°)
- Auto Scaling (í•„ìš” ì‹œì—ë§Œ í™•ì¥)
- Spot Instances ì§€ì› ê°€ëŠ¥

## âš ï¸ ì£¼ì˜ì‚¬í•­

### ë°°í¬ ì „
- [ ] AWS/Azure ìê²©ì¦ëª… í™•ì¸
- [ ] terraform.tfvars íŒŒì¼ ì„¤ì •
- [ ] Lambda í•¨ìˆ˜ íŒ¨í‚¤ì§•
- [ ] ì˜ˆìƒ ë¹„ìš© í™•ì¸ (~$400-600/ì›”)

### ë°°í¬ ì¤‘
- [ ] RDS ìƒì„± ì‹œê°„ 15-20ë¶„ ì†Œìš” (ì •ìƒ)
- [ ] VPN ì—°ê²° ì„¤ì • ì‹œê°„ 2-3ë¶„ ì†Œìš”
- [ ] ì „ì²´ ë°°í¬ ì‹œê°„ 20-30ë¶„

### ë°°í¬ í›„
- [ ] Health Check í™•ì¸
- [ ] CloudWatch ì•ŒëŒ ì´ë©”ì¼ êµ¬ë…
- [ ] Route 53 ë„¤ì„ì„œë²„ ì„¤ì • (ë„ë©”ì¸ ì‚¬ìš© ì‹œ)
- [ ] DR ì‚¬ì´íŠ¸ í…ŒìŠ¤íŠ¸

### ë¹„ìš© ê´€ë ¨
- âš ï¸ ë¦¬ì†ŒìŠ¤ ì‚¬ìš© ì‹œ ë¹„ìš© ë°œìƒ
- âš ï¸ ë¯¸ì‚¬ìš© ì‹œ `terraform destroy` ì‹¤í–‰
- âš ï¸ RDS ì¤‘ì§€ëŠ” ìµœëŒ€ 7ì¼ ì œí•œ
- âš ï¸ S3 ë°±ì—… íŒŒì¼ ì£¼ê¸°ì  ì •ë¦¬ í•„ìš”

## ğŸ“ ì§€ì› ë° ë¬¸ì˜

### ë¬¸ì œ ë°œìƒ ì‹œ
1. README.mdì˜ íŠ¸ëŸ¬ë¸”ìŠˆíŒ… ì„¹ì…˜ í™•ì¸
2. Terraform ë¡œê·¸ í™•ì¸ (`terraform apply -debug`)
3. AWS/Azure ì½˜ì†”ì—ì„œ ë¦¬ì†ŒìŠ¤ ìƒíƒœ í™•ì¸
4. GitHub Issuesì— ì§ˆë¬¸ ë‚¨ê¸°ê¸°

### ìœ ìš©í•œ ëª…ë ¹ì–´
```bash
# Terraform ìƒíƒœ í™•ì¸
terraform show
terraform state list

# AWS ë¦¬ì†ŒìŠ¤ í™•ì¸
aws ecs list-services --cluster ecs-cluster-prod
aws rds describe-db-instances

# Lambda ë¡œê·¸ í™•ì¸
aws logs tail /aws/lambda/db-sync-prod --follow
```

## ğŸ¯ í”„ë¡œì íŠ¸ ëª©í‘œ ë‹¬ì„± ì²´í¬ë¦¬ìŠ¤íŠ¸

- [x] AWS VPC ë„¤íŠ¸ì›Œí¬ êµ¬ì„±
- [x] Multi-AZ ê³ ê°€ìš©ì„± êµ¬í˜„
- [x] 3-Tier ì•„í‚¤í…ì²˜ ì„¤ê³„
- [x] ECS Fargate ì»¨í…Œì´ë„ˆ ë°°í¬
- [x] RDS MySQL Multi-AZ êµ¬ì„±
- [x] Lambda ìë™ ë°±ì—… ì‹œìŠ¤í…œ
- [x] Route 53 DNS Failover
- [x] CloudWatch ëª¨ë‹ˆí„°ë§
- [x] Auto Scaling êµ¬í˜„
- [x] ë³´ì•ˆ ê·¸ë£¹ ê³„ì¸µí™”
- [x] VPC Endpoints êµ¬ì„±
- [x] Infrastructure as Code (ì™„ì „ ìë™í™”)

## ğŸŒŸ í”„ë¡œì íŠ¸ í•˜ì´ë¼ì´íŠ¸

1. **ì™„ì „ ìë™í™”**: ëª¨ë“  ì¸í”„ë¼ë¥¼ ì½”ë“œë¡œ ê´€ë¦¬
2. **ê³ ê°€ìš©ì„±**: Multi-AZ + Auto Scaling + Health Check
3. **ì¬í•´ë³µêµ¬**: Warm Standby + DNS Failover
4. **ë³´ì•ˆ**: ê³„ì¸µë³„ ê²©ë¦¬ + VPN + ì•”í˜¸í™”
5. **ëª¨ë‹ˆí„°ë§**: CloudWatch ëŒ€ì‹œë³´ë“œ + ì‹¤ì‹œê°„ ì•ŒëŒ
6. **ë¹„ìš© ìµœì í™”**: Warm Standby + VPC Endpoints
7. **í™•ì¥ì„±**: ëª¨ë“ˆí™”ëœ êµ¬ì¡°ë¡œ ì‰¬ìš´ í™•ì¥

---

## ğŸŠ ìµœì¢… ë©”ì‹œì§€

**ì¶•í•˜í•©ë‹ˆë‹¤!** ğŸ‰

ë©€í‹°í´ë¼ìš°ë“œ ì¬í•´ë³µêµ¬ ì•„í‚¤í…ì²˜ Terraform êµ¬í˜„ì´ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤!

ì´ì œ ë‹¤ìŒ ëª…ë ¹ì–´ë¡œ ë°°í¬ë¥¼ ì‹œì‘í•˜ì„¸ìš”:

```bash
./deploy.sh
```

ê¶ê¸ˆí•œ ì ì´ ìˆìœ¼ë©´ README.mdë¥¼ ì°¸ê³ í•˜ê±°ë‚˜ ë¬¸ì˜í•´ì£¼ì„¸ìš”!

**Happy Deploying! ğŸš€**

---

**Made with â¤ï¸ for AWS2 Final Project**
*Infrastructure as Code with Terraform*
