# ğŸ—ï¸ ì•„í‚¤í…ì²˜ ë‹¤ì´ì–´ê·¸ë¨ ê°€ì´ë“œ

## ğŸ“Š ë‹¤ì´ì–´ê·¸ë¨ ê°œìš”

**arch.mermaid** íŒŒì¼ì€ ë©€í‹°í´ë¼ìš°ë“œ DR ì•„í‚¤í…ì²˜ë¥¼ ì‹œê°í™”í•œ Mermaid ë‹¤ì´ì–´ê·¸ë¨ì…ë‹ˆë‹¤.

---

## ğŸ¨ ë‹¤ì´ì–´ê·¸ë¨ íŠ¹ì§•

### âœ… ìˆ˜ì • ì‚¬í•­
1. **EKS ì¶”ê°€**: ECS â†’ EKSë¡œ ë³€ê²½ ë°˜ì˜
2. **ê°€ë¡œ ë ˆì´ì•„ì›ƒ**: ì¢Œìš°ë¡œ í¼ì³ì§„ êµ¬ì¡° (flowchart LR)
3. **ê°€ìš© ì˜ì—­ ê¸°ë°˜ ê·¸ë£¹í™”**: AZ-A, AZ-Cë¡œ ì¸ìŠ¤í„´ìŠ¤ ë¬¶ìŒ
4. **ì´ëª¨í‹°ì½˜ ì œê±°**: ê¹”ë”í•œ í…ìŠ¤íŠ¸ í‘œí˜„
5. **ëª…í™•í•œ ê³„ì¸µ**: Private Subnet ì•ˆì— EKS Nodeì™€ Pods ë°°ì¹˜

---

## ğŸ¢ ì•„í‚¤í…ì²˜ êµ¬ì¡°

### AWS Primary Site (ì¢Œì¸¡)
```
Internet â†’ Route 53
    â†“
External ALB (Public)
    â†“
EKS Control Plane (Managed)
    â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Availability Zone A     â”‚  Availability Zone C â”‚
â”‚  â”œâ”€ Private Subnet       â”‚  â”œâ”€ Private Subnet   â”‚
â”‚  â”‚  â”œâ”€ EKS Worker Node   â”‚  â”‚  â”œâ”€ EKS Worker Nodeâ”‚
â”‚  â”‚  â”‚  â”œâ”€ Web Pod        â”‚  â”‚  â”‚  â”œâ”€ Web Pod     â”‚
â”‚  â”‚  â”‚  â””â”€ WAS Pod        â”‚  â”‚  â”‚  â””â”€ WAS Pod     â”‚
â”‚  â”œâ”€ DB Subnet            â”‚  â”œâ”€ DB Subnet        â”‚
â”‚  â”‚  â””â”€ RDS Primary       â”‚  â”‚  â””â”€ RDS Standby   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â†“
Lambda (5ë¶„ ì£¼ê¸°) â†’ S3 â†’ VPN
```

### Azure DR Site (ìš°ì¸¡)
```
Application Gateway
    â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Availability Zone 1     â”‚  Availability Zone 2 â”‚
â”‚  â”œâ”€ AKS Subnet           â”‚  â”œâ”€ AKS Subnet       â”‚
â”‚  â”‚  â”œâ”€ AKS Worker Node   â”‚  â”‚  â”œâ”€ AKS Worker Nodeâ”‚
â”‚  â”‚  â”‚  â”œâ”€ Web Pod        â”‚  â”‚                    â”‚
â”‚  â”‚  â”‚  â””â”€ WAS Pod        â”‚  â”‚                    â”‚
â”‚  â”œâ”€ MySQL Subnet         â”‚  â”œâ”€ MySQL Subnet     â”‚
â”‚  â”‚  â””â”€ MySQL Primary     â”‚  â”‚  â””â”€ MySQL Standby â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â†‘
VPN â† Azure Function
```

---

## ğŸ¯ ì£¼ìš” ì»´í¬ë„ŒíŠ¸

### AWS ë¦¬ì†ŒìŠ¤
| ì»´í¬ë„ŒíŠ¸ | ì„¤ëª… | ìœ„ì¹˜ |
|----------|------|------|
| **Route 53** | DNS Failover + Health Check | AWS Services |
| **EKS Control Plane** | Kubernetes ë§ˆìŠ¤í„° ë…¸ë“œ (AWS ê´€ë¦¬) | AWS Services |
| **EKS Worker Node** | EC2 t3.medium | AZ-A, AZ-C |
| **Web Pod** | Nginx (Replica: 2) | EKS Node |
| **WAS Pod** | Spring Boot (Replica: 2) | EKS Node |
| **RDS MySQL** | Primary + Standby (Multi-AZ) | DB Subnet |
| **Lambda** | DB ì¦ë¶„ ë°±ì—… (5ë¶„ ì£¼ê¸°) | AWS Services |
| **S3** | ë°±ì—… ìŠ¤í† ë¦¬ì§€ | AWS Services |
| **CloudWatch** | ëª¨ë‹ˆí„°ë§ | AWS Services |

### Azure ë¦¬ì†ŒìŠ¤
| ì»´í¬ë„ŒíŠ¸ | ì„¤ëª… | ìœ„ì¹˜ |
|----------|------|------|
| **Application Gateway** | L7 ë¡œë“œ ë°¸ëŸ°ì„œ | VNet |
| **AKS Worker Node** | Standard_B2s (Warm Standby) | AZ-1, AZ-2 |
| **Web/WAS Pod** | Nginx + Spring Boot | AKS Node |
| **Azure MySQL** | Flexible Server (Standby) | MySQL Subnet |
| **Azure Function** | DB ë™ê¸°í™” í•¸ë“¤ëŸ¬ | Azure Services |

---

## ğŸ“ˆ ë°ì´í„° íë¦„

### 1. ì¼ë°˜ íŠ¸ë˜í”½ (Primary)
```
User â†’ Route 53 â†’ External ALB â†’ EKS Control Plane
    â†’ EKS Worker Nodes â†’ Web Pods â†’ WAS Pods â†’ RDS
```

### 2. Failover íŠ¸ë˜í”½ (DR)
```
User â†’ Route 53 (Failover) â†’ App Gateway
    â†’ AKS Worker Nodes â†’ Web Pods â†’ WAS Pods â†’ Azure MySQL
```

### 3. ë°ì´í„° ë™ê¸°í™”
```
RDS â†’ Lambda (5ë¶„) â†’ S3 â†’ VPN â†’ Azure Function â†’ Azure MySQL
```

---

## ğŸ¨ ìƒ‰ìƒ ì½”ë“œ

| ìƒ‰ìƒ | ìš©ë„ | ì»´í¬ë„ŒíŠ¸ |
|------|------|----------|
| **ì£¼í™©ìƒ‰** (#FF9900) | AWS ë¦¬ì†ŒìŠ¤ | EKS, Lambda, NAT |
| **íŒŒë€ìƒ‰** (#0078D4) | Azure ë¦¬ì†ŒìŠ¤ | AKS, Azure Function |
| **ë³´ë¼ìƒ‰** (#8C4FFF) | Load Balancer | ALB, App Gateway |
| **ì§„íŒŒë‘** (#3B48CC) | ë°ì´í„°ë² ì´ìŠ¤ | RDS, Azure MySQL |
| **ì´ˆë¡ìƒ‰** (#3F8624) | ìŠ¤í† ë¦¬ì§€ | S3 |
| **ë¹¨ê°„ìƒ‰** (#DD344C) | VPN | Site-to-Site VPN |
| **ë¶„í™ìƒ‰** (#E7157B) | ëª¨ë‹ˆí„°ë§ | CloudWatch, Route 53 |
| **ì¿ ë²„ íŒŒë‘** (#326CE5) | Kubernetes Pod | Web/WAS Pods |

---

## ğŸ“ Mermaid ë Œë”ë§ ë°©ë²•

### 1. GitHub
- `.mermaid` íŒŒì¼ì„ GitHubì— ì—…ë¡œë“œí•˜ë©´ ìë™ ë Œë”ë§

### 2. VS Code
```bash
# Mermaid Preview í™•ì¥ ì„¤ì¹˜
code --install-extension bierner.markdown-mermaid
```

### 3. ì˜¨ë¼ì¸ ì—ë””í„°
- https://mermaid.live/
- arch.mermaid ë‚´ìš©ì„ ë³µì‚¬í•˜ì—¬ ë¶™ì—¬ë„£ê¸°

### 4. Markdown ë¬¸ì„œì— í¬í•¨
```markdown
```mermaid
# arch.mermaid ë‚´ìš© ë¶™ì—¬ë„£ê¸°
` ``
```

---

## ğŸ”§ ë‹¤ì´ì–´ê·¸ë¨ ì»¤ìŠ¤í„°ë§ˆì´ì§•

### ë ˆì´ì•„ì›ƒ ë³€ê²½
```mermaid
flowchart LR  # ì¢Œâ†’ìš° (í˜„ì¬)
flowchart TB  # ìƒâ†’í•˜
flowchart RL  # ìš°â†’ì¢Œ
flowchart BT  # í•˜â†’ìƒ
```

### ìŠ¤íƒ€ì¼ ë³€ê²½
```mermaid
classDef myStyle fill:#ìƒ‰ìƒì½”ë“œ,stroke:#í…Œë‘ë¦¬ìƒ‰,stroke-width:2px
class ë…¸ë“œID myStyle
```

### í™”ì‚´í‘œ ìŠ¤íƒ€ì¼
```mermaid
A --> B    # ì‹¤ì„  í™”ì‚´í‘œ
A -.-> B   # ì ì„  í™”ì‚´í‘œ (Failover)
A ==> B    # êµµì€ í™”ì‚´í‘œ
A <--> B   # ì–‘ë°©í–¥ í™”ì‚´í‘œ (Sync)
```

---

## ğŸ“Š ê°€ìš© ì˜ì—­ êµ¬ì„±

### AWS (ap-northeast-2)
- **AZ-A** (ap-northeast-2a)
  - Private Subnet: 10.0.11.0/24
  - DB Subnet: 10.0.31.0/24
  - EKS Worker Node + Pods
  - RDS Primary

- **AZ-C** (ap-northeast-2c)
  - Private Subnet: 10.0.12.0/24
  - DB Subnet: 10.0.32.0/24
  - EKS Worker Node + Pods
  - RDS Standby

### Azure (Korea Central)
- **Zone 1**
  - AKS Subnet: 172.16.11.0/24
  - MySQL Subnet: 172.16.21.0/24
  - AKS Worker Node + Pods
  - Azure MySQL Primary

- **Zone 2**
  - AKS Subnet: 172.16.12.0/24
  - MySQL Subnet: 172.16.22.0/24
  - AKS Worker Node
  - Azure MySQL Standby

---

## ğŸ¯ í•µì‹¬ íŠ¹ì§•

### 1. EKS ê¸°ë°˜ ì»¨í…Œì´ë„ˆ ì˜¤ì¼€ìŠ¤íŠ¸ë ˆì´ì…˜
- Kubernetes ë„¤ì´í‹°ë¸Œ
- Pod ë‹¨ìœ„ ë°°í¬ ë° ìŠ¤ì¼€ì¼ë§
- AWS Load Balancer Controller ì—°ë™

### 2. Multi-AZ ê³ ê°€ìš©ì„±
- 2ê°œ ì´ìƒì˜ ê°€ìš© ì˜ì—­ì— ë¦¬ì†ŒìŠ¤ ë¶„ì‚°
- RDS Multi-AZ ìë™ í˜ì¼ì˜¤ë²„
- EKS Worker Node ë‹¤ì¤‘ ë°°ì¹˜

### 3. ê°€ë¡œ ë ˆì´ì•„ì›ƒì˜ ì¥ì 
- AWS â† â†’ Azure ë³‘ë ¬ ë¹„êµ ìš©ì´
- Primary â† â†’ DR ê´€ê³„ ëª…í™•
- ë°ì´í„° íë¦„ ì¶”ì  í¸ë¦¬

### 4. ê°€ìš© ì˜ì—­ ê·¸ë£¹í™”
- ë¬¼ë¦¬ì  ë°°ì¹˜ ëª…í™•í™”
- ì¥ì•  ì˜ì—­ ê²©ë¦¬ ì‹œê°í™”
- ë„¤íŠ¸ì›Œí¬ í† í´ë¡œì§€ ì´í•´ ìš©ì´

---

## ğŸ“š ì°¸ê³  ìë£Œ

- **Mermaid ê³µì‹ ë¬¸ì„œ**: https://mermaid.js.org/
- **AWS ì•„í‚¤í…ì²˜ ì•„ì´ì½˜**: https://aws.amazon.com/architecture/icons/
- **Azure ì•„í‚¤í…ì²˜ ì•„ì´ì½˜**: https://learn.microsoft.com/azure/architecture/icons/

---

## âœ… ë‹¤ì´ì–´ê·¸ë¨ ì²´í¬ë¦¬ìŠ¤íŠ¸

- [x] EKS ì»´í¬ë„ŒíŠ¸ ì¶”ê°€
- [x] ê°€ë¡œ ë ˆì´ì•„ì›ƒ (LR) ì ìš©
- [x] ê°€ìš© ì˜ì—­ë³„ ê·¸ë£¹í™”
- [x] ì´ëª¨í‹°ì½˜ ì œê±°
- [x] Private Subnet â†’ AZ ê¸°ë°˜ êµ¬ì¡°ë¡œ ë³€ê²½
- [x] EKS Control Plane ëª…ì‹œ
- [x] Kubernetes Pods í‘œì‹œ
- [x] ë°ì´í„° ë™ê¸°í™” íë¦„ í‘œí˜„
- [x] Multi-AZ ê´€ê³„ ì‹œê°í™”
- [x] ìƒ‰ìƒ ì½”ë“œ ì¼ê´€ì„± ìœ ì§€

---

**ì™„ì„±ëœ ì•„í‚¤í…ì²˜ ë‹¤ì´ì–´ê·¸ë¨ìœ¼ë¡œ í”„ë¡œì íŠ¸ë¥¼ ëª…í™•í•˜ê²Œ ì„¤ëª…í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤!** ğŸ‰
